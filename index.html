<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Mini Bar Management</title>
    <style>
        /* Z√ÅKLADN√ç STYLING */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            color: #333;
            background: linear-gradient(135deg, #ff4e50, #f9d423);
            position: relative;
        }
        .container {
            width: 100%;
            max-width: 480px;
            margin: 20px auto;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
        }
        h1 {
            text-align: center;
            font-size: 32px;
            margin-bottom: 20px;
            color: #ff4e50;
            text-transform: uppercase;
        }
        .item, .form-group {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 10px 15px;
            border-radius: 12px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        .wellness, .city-tax {
            background: linear-gradient(135deg, #ffeaa7, #fab1a0);
        }
        .beer {
            background: linear-gradient(135deg, #f3a683, #f7d794);
        }
        .cocktail {
            background: linear-gradient(135deg, #786fa6, #a29bfe);
        }
        .softdrink {
            background: linear-gradient(135deg, #63cdda, #81ecec);
        }
        .utility {
            background: linear-gradient(135deg, #fdcb6e, #ffeaa7);
        }
        .default {
            background: linear-gradient(135deg, #bdc3c7, #2c3e50);
        }
        .item-icon {
            font-size: 28px;
            color: #fff;
        }
        .item-name {
            flex: 1;
            margin-left: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #fff;
        }
        .item-input {
            width: 80px;
            font-size: 16px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
        }
        button {
            display: block;
            width: 100%;
            max-width: 320px;
            margin: 20px auto;
            padding: 15px;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background: linear-gradient(135deg, #2980b9, #27ae60);
        }

        /* IKONKA V PRAV√âM HORN√çM ROHU PRO VYMAZ√ÅN√ç localStorage */
        .clear-storage-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        /* SKRYT√ç ELEMENTU (nap≈ô. pro fakturu) */
        .hidden {
            display: none;
        }

        /* STYLING FAKTURY */
        #invoice {
            margin-top: 20px;
            border: 2px dashed #ccc;
            padding: 15px;
            border-radius: 8px;
            background: #fafafa;
        }
        #invoice-details p {
            margin: 4px 0;
        }
    </style>
</head>
<body>
    <!-- IKONKA PRO VYMAZ√ÅN√ç LOCALSTORAGE -->
    <button class="clear-storage-icon" onclick="clearStorage()" title="Vymazat localStorage">
        üßπ
    </button>

    <div class="container">
        <h1>Mini Bar Management</h1>

        <!-- V√ùBƒöR VILY -->
        <div class="form-group wellness">
            <div class="item-icon">üè°</div>
            <label for="vila" class="item-name">V√Ωbƒõr vily:</label>
            <select id="vila" class="item-input">
                <option value="ohyeah">Oh Yeah Villa</option>
                <option value="castle">The Little Castle</option>
                <option value="pool">Amazing Pool</option>
            </select>
        </div>

        <!-- V√ùBƒöR MƒöNY (EUR / CZK) -->
        <div class="form-group wellness">
            <div class="item-icon">üí∂</div>
            <label for="currency" class="item-name">Mƒõna:</label>
            <select id="currency" class="item-input">
                <option value="EUR">EUR</option>
                <option value="CZK">CZK</option>
            </select>
        </div>

        <!-- WELLNESS -->
        <div class="form-group wellness">
            <div class="item-icon">üõÅ</div>
            <label for="wellness" class="item-name">Wellness:</label>
            <input type="number" id="wellness" placeholder="Zadejte ƒç√°stku" min="0" class="item-input" />
        </div>

        <!-- MƒöSTSK√Å DA≈á (CITY TAX) -->
        <div class="form-group city-tax">
            <div class="item-icon">üåÜ</div>
            <label for="guests" class="item-name">Poƒçet host≈Ø:</label>
            <input type="number" id="guests" placeholder="Zadejte poƒçet" min="0" class="item-input" />
        </div>
        <div class="form-group city-tax">
            <div class="item-icon">üõèÔ∏è</div>
            <label for="nights" class="item-name">Poƒçet noc√≠:</label>
            <input type="number" id="nights" placeholder="Zadejte poƒçet" min="0" class="item-input" />
        </div>

        <!-- SLEVA 10% (KROMƒö CITY TAX) -->
        <div class="form-group city-tax">
            <div class="item-icon">üí∞</div>
            <label for="discount" class="item-name" style="flex:none;">Sleva 10%:</label>
            <input type="checkbox" id="discount" style="width:auto;" />
        </div>

        <!-- POLO≈ΩKY SKLADU -->
        <div id="items"></div>

        <!-- V√ùBƒöR STAVU PLATBY -->
        <div class="form-group city-tax">
            <div class="item-icon">üí≥</div>
            <label for="paymentStatus" class="item-name">Stav platby:</label>
            <select id="paymentStatus" class="item-input">
                <option value="Paid Cash">Paid Cash</option>
                <option value="Paid Card">Paid Card</option>
                <option value="Not yet">Not yet</option>
            </select>
        </div>

        <!-- TLAƒå√çTKA -->
        <button onclick="generateInvoice()">Generovat fakturu</button>
        <button onclick="window.location.href='sklad.html'">P≈ôej√≠t do skladu</button>

        <!-- FAKTURA -->
        <div id="invoice" class="invoice hidden">
            <h2>Faktura</h2>
            <div id="invoice-details"></div>
            <div id="invoice-total"></div>
        </div>
    </div>

    <script>
        /* ----------------------------------------------------------------------------------
           V√ùCHOZ√ç SKLAD (SHODN√ù S T√çM, CO BUDE VE SKLAD.HTML)
        ---------------------------------------------------------------------------------- */
        const defaultSklad = {
            "Budvar": 50,
            "Malibu": 48,
            "Jack s colou": 50,
            "Moscow Mule": 30,
            "Gin-Tonic": 50,
            "Mojito": 30,
            "Coca-Cola": 100,
            "Sprite": 100,
            "Red Bull": 100,
            "Prosecco": 20,
            "Pivo sud 30 l": 10,
            "Pivo sud 50 l": 5,
            "Plyn": 12,
            "Gril": 20
        };

        // Naƒçteme z localStorage (pokud existuje), jinak pou≈æijeme default
        let sklad = JSON.parse(localStorage.getItem("sklad")) || defaultSklad;

        /* ----------------------------------------------------------------------------------
           P≈òI≈òAZEN√ç IKON A KATEGORI√ç PRO POLO≈ΩKY
        ---------------------------------------------------------------------------------- */
        const icons = {
            "Budvar": "üç∫",
            "Malibu": "üçπ",
            "Jack s colou": "ü•É",
            "Moscow Mule": "üç∏",
            "Gin-Tonic": "üç∏",
            "Mojito": "üçπ",
            "Coca-Cola": "ü•§",
            "Sprite": "ü•§",
            "Red Bull": "ü™Ω",
            "Prosecco": "üçæ",
            "Pivo sud 30 l": "üç∫",
            "Pivo sud 50 l": "üç∫",
            "Plyn": "üî•",
            "Gril": "üçñ"
        };

        const categories = {
            "Budvar": "beer",
            "Pivo sud 30 l": "beer",
            "Pivo sud 50 l": "beer",
            "Malibu": "cocktail",
            "Jack s colou": "cocktail",
            "Moscow Mule": "cocktail",
            "Gin-Tonic": "cocktail",
            "Mojito": "cocktail",
            "Prosecco": "cocktail",
            "Coca-Cola": "softdrink",
            "Sprite": "softdrink",
            "Red Bull": "softdrink",
            "Plyn": "utility",
            "Gril": "utility"
        };

        /* ----------------------------------------------------------------------------------
           KURZY PRO JEDNODUCH√ù P≈òEVOD (1 EUR = 24 CZK)
        ---------------------------------------------------------------------------------- */
        const exchangeRates = {
            EUR: 1,
            CZK: 24
        };
        // Symboly mƒõn
        const currencySymbols = {
            EUR: "‚Ç¨",
            CZK: "Kƒç"
        };

        /* ----------------------------------------------------------------------------------
           FUNKCE PRO NAƒåTEN√ç POLO≈ΩEK ZE SKLADU DO UI
        ---------------------------------------------------------------------------------- */
        function loadItems() {
            const container = document.getElementById("items");
            container.innerHTML = "";
            Object.keys(sklad).forEach(itemName => {
                const item = document.createElement("div");
                item.classList.add("item");
                item.classList.add(categories[itemName] || "default");

                const icon = document.createElement("div");
                icon.classList.add("item-icon");
                icon.textContent = icons[itemName] || "üì¶";

                const name = document.createElement("div");
                name.classList.add("item-name");
                name.textContent = `${itemName} (${sklad[itemName]} ks skladem)`;

                const input = document.createElement("input");
                input.type = "number";
                input.min = "0";
                input.placeholder = "Zadejte poƒçet";
                input.classList.add("item-input");
                input.id = `${itemName}-count`;

                item.appendChild(icon);
                item.appendChild(name);
                item.appendChild(input);

                container.appendChild(item);
            });
        }

        /* ----------------------------------------------------------------------------------
           V√ùPOƒåET FAKTURY
        ---------------------------------------------------------------------------------- */
        function generateInvoice() {
            const vila = document.getElementById("vila").value;
            const wellness = parseFloat(document.getElementById("wellness").value) || 0;
            const guests = parseInt(document.getElementById("guests").value) || 0;
            const nights = parseInt(document.getElementById("nights").value) || 0;
            const discountChecked = document.getElementById("discount").checked;
            const paymentStatus = document.getElementById("paymentStatus").value;
            const selectedCurrency = document.getElementById("currency").value;

            // City Tax = 2 EUR za osobu/noc (v EUR)
            //   - i kdy≈æ jsme v CZK, poƒç√≠t√°me to nejprve v EUR, potom p≈ôepoƒçteme
            const cityTaxEUR = guests * nights * 2;

            // Zaƒçneme rekapitulac√≠
            let details = `<p><strong>Vila:</strong> ${vila}</p>`;
            details += `<p><strong>Wellness:</strong> ${wellness.toFixed(2)} ‚Ç¨</p>`;
            details += `<p><strong>City Tax:</strong> ${cityTaxEUR.toFixed(2)} ‚Ç¨ ( ${guests} host≈Ø √ó ${nights} noc√≠ √ó 2‚Ç¨ )</p>`;

            // Seƒçteme minibar polo≈æky
            let sumItemsEUR = 0;
            Object.keys(sklad).forEach(itemName => {
                const input = document.getElementById(`${itemName}-count`);
                const count = parseInt(input.value) || 0;
                if (count > 0) {
                    // Odeƒçteme z "sklad"
                    sklad[itemName] = Math.max(0, sklad[itemName] - count);

                    // Jednotkov√° cena pro uk√°zku: 10 ‚Ç¨ / kus
                    const priceEUR = count * 10;
                    sumItemsEUR += priceEUR;
                    details += `<p>${count}√ó ${itemName}: ${priceEUR.toFixed(2)} ‚Ç¨</p>`;
                }
            });

            // ƒå√°stka v EUR za wellness + minibar (bez City Tax)
            let subtotalEUR = wellness + sumItemsEUR;

            // Sleva 10 % na subtotal (pokud je discountChecked)
            // City Tax (cityTaxEUR) se neslev≈àuje
            if (discountChecked) {
                subtotalEUR *= 0.9; // odeƒçteme 10%
                details += `<p><em>Sleva 10% na wellness a polo≈æky minibaru (kromƒõ City Tax)</em></p>`;
            }

            // Celkov√° ƒç√°stka v EUR
            let totalEUR = subtotalEUR + cityTaxEUR;

            // P≈ôevedeme do vybran√© mƒõny (EUR / CZK)
            const rate = exchangeRates[selectedCurrency] || 1; 
            const symbol = currencySymbols[selectedCurrency] || "‚Ç¨";
            const finalTotal = totalEUR * rate;

            // Ulo≈æ√≠me nov√Ω stav skladu do localStorage
            localStorage.setItem("sklad", JSON.stringify(sklad));

            // P≈ôid√°me stav platby
            details += `<p><strong>Stav platby:</strong> ${paymentStatus}</p>`;

            // Zobraz√≠me fin√°ln√≠ ƒç√°stku v zvolen√© mƒõnƒõ
            document.getElementById("invoice-details").innerHTML = details;
            document.getElementById("invoice-total").innerHTML = `
                <h3>Celkem: ${finalTotal.toFixed(2)} ${symbol}</h3>
            `;

            // Zobraz√≠me box s fakturou
            document.getElementById("invoice").classList.remove("hidden");
        }

        /* ----------------------------------------------------------------------------------
           FUNKCE PRO VYMAZ√ÅN√ç LOCALSTORAGE
        ---------------------------------------------------------------------------------- */
        function clearStorage() {
            localStorage.removeItem("sklad");
            alert("LocalStorage byla vymaz√°na. Obnovte str√°nku.");
        }

        /* ----------------------------------------------------------------------------------
           KDY≈Ω SE STR√ÅNKA NAƒåTE, PROVEDEME loadItems()
        ---------------------------------------------------------------------------------- */
        window.onload = loadItems;
    </script>
</body>
</html>