<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini Bar Management</title>
  <style>
    /* ===================== Z√ÅKLADN√ç STYLING STR√ÅNKY ===================== */
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
      background: linear-gradient(135deg, #ff4e50, #f9d423);
      position: relative;
    }
    .container {
      width: 100%;
      max-width: 480px;
      margin: 20px auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      padding: 20px;
      box-sizing: border-box;
      position: relative;
    }
    h1 {
      text-align: center;
      font-size: 32px;
      margin-bottom: 20px;
      color: #ff4e50;
      text-transform: uppercase;
    }
    .item, .form-group {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding: 10px 15px;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
    .wellness, .city-tax {
      background: linear-gradient(135deg, #ffeaa7, #fab1a0);
    }
    .beer {
      background: linear-gradient(135deg, #f3a683, #f7d794);
    }
    .cocktail {
      background: linear-gradient(135deg, #786fa6, #a29bfe);
    }
    .softdrink {
      background: linear-gradient(135deg, #63cdda, #81ecec);
    }
    .utility {
      background: linear-gradient(135deg, #fdcb6e, #ffeaa7);
    }
    .default {
      background: linear-gradient(135deg, #bdc3c7, #2c3e50);
    }
    .item-icon {
      font-size: 28px;
      color: #fff;
    }
    .item-name {
      flex: 1;
      margin-left: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #fff;
    }
    .item-input {
      width: 80px;
      font-size: 16px;
      padding: 5px;
      border: 1px solid #ddd;
      border-radius: 8px;
      text-align: center;
    }
    button {
      display: block;
      width: 100%;
      max-width: 320px;
      margin: 20px auto;
      padding: 15px;
      background: linear-gradient(135deg, #3498db, #2ecc71);
      color: white;
      font-size: 18px;
      font-weight: bold;
      text-transform: uppercase;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }
    button:hover {
      background: linear-gradient(135deg, #2980b9, #27ae60);
    }

    /* IKONKA PRO MAZ√ÅN√ç localStorage (vpravo naho≈ôe) */
    .clear-storage-icon {
      position: absolute;
      top: 10px;
      right: 10px;
      background: transparent;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
    }

    /* Skryt√≠ element≈Ø */
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Tlaƒç√≠tko pro smaz√°n√≠ localStorage -->
  <button class="clear-storage-icon" onclick="clearStorage()" title="Vymazat localStorage">
    üßπ
  </button>

  <div class="container">
    <h1>Mini Bar Management</h1>

    <!-- Wellness (EUR) -->
    <div class="form-group wellness">
      <div class="item-icon">üõÅ</div>
      <label for="wellness" class="item-name">Wellness (v ‚Ç¨):</label>
      <input type="number" id="wellness" placeholder="Zadejte ƒç√°stku" min="0" class="item-input" />
    </div>

    <!-- City Tax -->
    <div class="form-group city-tax">
      <div class="item-icon">üåÜ</div>
      <label for="guests" class="item-name">Poƒçet host≈Ø:</label>
      <input type="number" id="guests" placeholder="Zadejte poƒçet" min="0" class="item-input" />
    </div>
    <div class="form-group city-tax">
      <div class="item-icon">üõèÔ∏è</div>
      <label for="nights" class="item-name">Poƒçet noc√≠:</label>
      <input type="number" id="nights" placeholder="Zadejte poƒçet" min="0" class="item-input" />
    </div>

    <!-- Sleva 10% (kromƒõ City Tax) -->
    <div class="form-group city-tax">
      <div class="item-icon">üí∞</div>
      <label for="discount" class="item-name" style="flex:none;">Sleva 10 %:</label>
      <input type="checkbox" id="discount" style="width:auto;" />
    </div>

    <!-- Polo≈æky skladu -->
    <div id="items"></div>

    <!-- Tlaƒç√≠tko pro vygenerov√°n√≠ faktury -->
    <button onclick="generateInvoice()">Generovat fakturu</button>
  </div>

  <script>
    /************************************************************************
      1) STAV SKLADU: Kolik kus≈Ø m√°me k dispozici
    ************************************************************************/
    const defaultSklad = {
      "Budvar": 50,
      "Malibu": 48,
      "Jack s colou": 50,
      "Moscow Mule": 30,
      "Gin-Tonic": 50,
      "Mojito": 30,
      "Coca-Cola": 100,
      "Sprite": 100,
      "Red Bull": 100,
      "Prosecco": 20,
      "Pivo sud 30 l": 5,
      "Pivo sud 50 l": 3,
      "Plyn": 10
    };

    // Naƒçten√≠ z localStorage (pokud existuje), jinak pou≈æijeme default
    let sklad = JSON.parse(localStorage.getItem("sklad")) || defaultSklad;

    /************************************************************************
      2) CEN√çK (s uvedenou mƒõnou). V≈°e p≈ôev√°d√≠me do EUR ve faktu≈ôe.
         - Polo≈æky s cenou v CZK -> kurz 1 EUR = 24 CZK
         - Polo≈æky v EUR -> beze zmƒõny
         - Wellness je zadan√Ω u≈æivatelem (v EUR)
         - City Tax se poƒç√≠t√° pevnou sazbou 2 EUR / host / noc
         - Sleva 10 % se aplikuje na v≈°e, kromƒõ City Tax
    ************************************************************************/
    const exchangeRateCZK = 24; // 1 EUR = 24 CZK

    // Uv√°d√≠me ceny polo≈æek, *i mƒõnu*, abychom mohli p≈ôev√©st do EUR
    const itemPrices = {
      "Budvar":       { value: 59,  currency: "CZK" },
      "Malibu":       { value: 99,  currency: "CZK" },
      "Jack s colou": { value: 99,  currency: "CZK" },
      "Moscow Mule":  { value: 99,  currency: "CZK" },
      "Gin-Tonic":    { value: 99,  currency: "CZK" },
      "Mojito":       { value: 99,  currency: "CZK" },
      "Coca-Cola":    { value: 32,  currency: "CZK" },
      "Sprite":       { value: 32,  currency: "CZK" },
      "Red Bull":     { value: 59,  currency: "CZK" },
      "Prosecco":     { value: 390, currency: "CZK" },
      "Pivo sud 30 l":{ value: 125, currency: "EUR" },
      "Pivo sud 50 l":{ value: 175, currency: "EUR" },
      "Plyn":         { value: 12,  currency: "EUR" }
      // Ostatn√≠ polo≈æky, kter√© by tu nebyly, lze o≈°et≈ôit:
      // -> if undefined => default nap≈ô. 10 EUR
    };

    /************************************************************************
      3) IKONY A KATEGORIE PRO STYLING
    ************************************************************************/
    const icons = {
      "Budvar": "üç∫",
      "Malibu": "üçπ",
      "Jack s colou": "ü•É",
      "Moscow Mule": "üç∏",
      "Gin-Tonic": "üç∏",
      "Mojito": "üçπ",
      "Coca-Cola": "ü•§",
      "Sprite": "ü•§",
      "Red Bull": "ü™Ω",
      "Prosecco": "üçæ",
      "Pivo sud 30 l": "üç∫",
      "Pivo sud 50 l": "üç∫",
      "Plyn": "üî•"
    };

    const categories = {
      "Budvar": "beer",
      "Pivo sud 30 l": "beer",
      "Pivo sud 50 l": "beer",
      "Malibu": "cocktail",
      "Jack s colou": "cocktail",
      "Moscow Mule": "cocktail",
      "Gin-Tonic": "cocktail",
      "Mojito": "cocktail",
      "Prosecco": "cocktail",
      "Coca-Cola": "softdrink",
      "Sprite": "softdrink",
      "Red Bull": "softdrink",
      "Plyn": "utility"
    };

    /************************************************************************
      4) FUNKCE, KTER√Å VR√ÅT√ç CENU JEDNOHO POLO≈ΩKY V EUR
    ************************************************************************/
    function getPriceInEUR(itemName) {
      const priceInfo = itemPrices[itemName];
      if (!priceInfo) {
        // Pokud v tabulce nen√≠, bereme 10 EUR jako default
        return 10.0;
      }
      // Pokud mƒõna = "CZK", p≈ôevedeme na EUR
      if (priceInfo.currency === "CZK") {
        return priceInfo.value / exchangeRateCZK;
      } else {
        // Jinak je to EUR
        return priceInfo.value;
      }
    }

    /************************************************************************
      5) ZOBRAZEN√ç POLO≈ΩEK ZE SKLADU DO HTML
    ************************************************************************/
    function loadItems() {
      const container = document.getElementById("items");
      container.innerHTML = "";
      Object.keys(sklad).forEach(itemName => {
        const itemDiv = document.createElement("div");
        itemDiv.classList.add("item");
        itemDiv.classList.add(categories[itemName] || "default");

        const icon = document.createElement("div");
        icon.classList.add("item-icon");
        icon.textContent = icons[itemName] || "üì¶";

        const name = document.createElement("div");
        name.classList.add("item-name");
        name.textContent = `${itemName} (${sklad[itemName]} ks skladem)`;

        const input = document.createElement("input");
        input.type = "number";
        input.min = "0";
        input.placeholder = "Zadejte poƒçet";
        input.classList.add("item-input");
        input.id = `${itemName}-count`;

        itemDiv.appendChild(icon);
        itemDiv.appendChild(name);
        itemDiv.appendChild(input);

        container.appendChild(itemDiv);
      });
    }

    /************************************************************************
      6) GENEROV√ÅN√ç FAKTURY (v EUR)
    ************************************************************************/
    function generateInvoice() {
      // Naƒçteme vstupy
      const wellness = parseFloat(document.getElementById("wellness").value) || 0;
      const guests = parseInt(document.getElementById("guests").value) || 0;
      const nights = parseInt(document.getElementById("nights").value) || 0;
      const discountChecked = document.getElementById("discount").checked;

      // Spoƒç√≠t√°me city tax (2 ‚Ç¨ / host / noc)
      const cityTax = guests * nights * 2; // v EUR

      // Rekapitulace
      let invoice = {
        wellness: wellness,
        cityTax: cityTax,
        items: {},
        discount: discountChecked,
        totalEUR: 0
      };

      // Seƒçteme minibar polo≈æky (v EUR)
      let sumItemsEUR = 0;
      Object.keys(sklad).forEach(itemName => {
        const count = parseInt(document.getElementById(`${itemName}-count`).value) || 0;
        if (count > 0) {
          // Odeƒçten√≠ ze skladu
          sklad[itemName] = Math.max(0, sklad[itemName] - count);

          // Cena 1 ks v EUR
          const pricePerItemEUR = getPriceInEUR(itemName);
          const totalThisItem = pricePerItemEUR * count;
          sumItemsEUR += totalThisItem;

          // P≈ôid√°me do rekapitulace
          invoice.items[itemName] = {
            count: count,
            priceEUR: pricePerItemEUR.toFixed(2),
            totalEUR: totalThisItem.toFixed(2)
          };
        }
      });

      // Subtotal (wellness + minibar) -> sem aplikujeme slevu 10 %
      let subtotalEUR = wellness + sumItemsEUR;
      if (discountChecked) {
        subtotalEUR *= 0.9; // -10 %
      }

      // Celkem (v EUR) = subtotal + cityTax
      let totalEUR = subtotalEUR + cityTax;

      // Ulo≈æ√≠me nov√Ω stav skladu do localStorage
      localStorage.setItem("sklad", JSON.stringify(sklad));

      // Ulo≈æ√≠me fakturaƒçn√≠ data do localStorage
      const selectedCurrency = "EUR"; // Vygenerov√°n√≠ faktury v EUR
      invoice.totalEUR = totalEUR.toFixed(2);
      invoice.selectedCurrency = selectedCurrency;
      invoice.paymentStatus = "Not yet"; // V√Ωchoz√≠ stav platby, lze roz≈°√≠≈ôit

      // Ulo≈æ√≠me do localStorage
      localStorage.setItem("invoice", JSON.stringify(invoice));

      // P≈ôesmƒõrov√°n√≠ na str√°nku faktury
      window.location.href = "invoice.html";
    }

    /************************************************************************
      7) MAZ√ÅN√ç localStorage
    ************************************************************************/
    function clearStorage() {
      localStorage.removeItem("sklad");
      localStorage.removeItem("invoice");
      alert("LocalStorage byla vymaz√°na. Obnovte str√°nku.");
    }

    /************************************************************************
      8) PO NAƒåTEN√ç STR√ÅNKY
    ************************************************************************/
    window.onload = loadItems;
  </script>
</body>
</html>